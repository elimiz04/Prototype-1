<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Background Audio and Word-by-Word Highlighting</title>
    <style>
        /* General reset and body styles */
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
            position: relative;
            font-family: Arial, sans-serif;
            font-size: 16px;
        }

        /* Styling for the highlighted word */
        .highlight {
            background-color: yellow;
            font-weight: bold;
        }

        /* Container for the colored rectangle */
        #rectangle-container {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 366px;
            height: 584px;
            background-color: #DEBDAA;
            border-radius: 69px;
            padding: 20px;
            overflow-y: auto;
            z-index: 10;
        }

        /* Styling for the text container inside the rectangle */
        #text-container {
            color: black;
            font-size: 16px;
            line-height: 1.5;
            max-width: 100%;
            overflow-wrap: break-word;
        }

        #text-container p {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

<!-- Background audio (hidden) -->
<audio id="background-audio" preload="auto">
    <source src="https://www.dropbox.com/scl/fi/j5w8mpmtcbf83x31mz4a6/chapter-1-page-1-fast-speed.mp3?rlkey=d37gta9ce94hoe9efkgs384m6&st=ybiqscpi&dl=1" type="audio/mpeg">
    Your browser does not support the audio element.
</audio>

<!-- Container for the colored rectangle -->
<div id="rectangle-container">
    <div id="text-container">
        <p id="text1">As you stand atop the cliff overlooking the Mediterranean Sea, you find yourself transported over 5,000 years into the past.</p>
        <p id="text2">Before cities, before written language—there was Ħaġar Qim.</p>
        <p id="text3">Perched above the coastline, this sacred space was built by a community deeply connected to nature and the cosmos.</p>
        <p id="text4">They raised temples using sheer will and wisdom passed down through generations.</p>
        <p id="text5">A sea breeze brushes your face. It’s the same wind those ancient people felt.</p>
        <p id="text6">The sun above still aligns with the temple on the summer solstice—just as they intended.</p>
    </div>
</div>

<script>
    // Get the audio element
    const audio = document.getElementById('background-audio');

    // Get the text elements
    const textElements = [
        document.getElementById('text1'),
        document.getElementById('text2'),
        document.getElementById('text3'),
        document.getElementById('text4'),
        document.getElementById('text5'),
        document.getElementById('text6')
    ];

    // Split each paragraph into words and store them
    let wordsArray = [];
    textElements.forEach((textElement, index) => {
        const words = textElement.innerText.split(' ');
        wordsArray.push(words);
        textElement.innerHTML = words.map(word => <span class="word">${word}</span>).join(' ');
    });

    // Map words to their timestamps in the audio (in seconds)
    const wordTimes = {
        text1: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13],
        text2: [14, 15, 16, 17, 18, 19, 20, 21, 22, 23],
        text3: [24, 25, 26, 27, 28, 29, 30, 31],
        text4: [32, 33, 34, 35, 36, 37, 38, 39],
        text5: [40, 41, 42, 43, 44, 45],
        text6: [46, 47, 48, 49, 50, 51]
    };

    // Function to highlight words based on the current time of the audio
    function highlightWords() {
        const currentTime = audio.currentTime;

        // Reset all highlights
        document.querySelectorAll('.word').forEach(word => word.classList.remove('highlight'));

        // Check each paragraph and highlight words based on current time
        for (let i = 0; i < textElements.length; i++) {
            const words = wordsArray[i];
            const timings = wordTimes[text${i + 1}];

            words.forEach((word, index) => {
                const wordElement = textElements[i].children[index];
                if (currentTime >= timings[index] && currentTime < (timings[index] + 1)) {  // Each word takes ~1 second
                    wordElement.classList.add('highlight');
                }
            });
        }
    }

    // Start playing audio after 3 seconds
    setTimeout(() => {
        audio.play();
    }, 3000);

    // Set interval to check the audio time and highlight words
    setInterval(highlightWords, 100); // Check every 100ms
</script>

</body>
</html>
